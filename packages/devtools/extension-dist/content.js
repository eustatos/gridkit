var GridKitDevTools;(()=>{function e(e,o){if(e){if("string"==typeof e)return t(e,o);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,o):void 0}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}function o(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t,o){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=i(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}console.log("[GridKit DevTools] Content script loaded"),function(){if(window.__GRIDKIT_DEVTOOLS_CONTENT__)console.log("[GridKit DevTools] Content script already loaded");else{window.__GRIDKIT_DEVTOOLS_CONTENT__=!0;var o,r=!1,a=null,s=new Map;chrome.runtime.onMessage.addListener(function(e,t,o){if("gridkit-devtools-background"===e.source)switch(console.log("[GridKit DevTools] Content received:",e.type),e.type){case"BACKEND_READY":r||(window.postMessage({source:"gridkit-devtools-content",type:"CONTENT_READY",timestamp:Date.now()},"*"),r=!0,console.log("[GridKit DevTools] Connected to backend")),o({type:"CONTENT_READY"});break;case"COMMAND":return l(e.payload).then(function(e){o({type:"RESPONSE",payload:e})}).catch(function(e){o({type:"RESPONSE",payload:{success:!1,error:e.message}})}),!0;default:console.warn("[GridKit DevTools] Unknown message type:",e.type)}}),window.addEventListener("message",function(e){var t,o;if(e.source===window&&e.data&&"object"===i(e.data)){var n=e.data.source;if("gridkit-devtools-backend"===n||"backend"===n){console.log("[GridKit DevTools] Content received from backend:",e.data.type);var r=e.data;switch(r.type){case"TABLE_REGISTERED":console.log("[GridKit DevTools] Table registered:",null===(t=r.payload)||void 0===t||null===(t=t.table)||void 0===t?void 0:t.id);break;case"TABLE_UNREGISTERED":console.log("[GridKit DevTools] Table unregistered:",null===(o=r.payload)||void 0===o?void 0:o.tableId);break;case"STATE_UPDATE":console.log("[GridKit DevTools] State update for table:",r.tableId);break;case"EVENT_LOGGED":console.log("[GridKit DevTools] Event logged for table:",r.tableId);break;case"PERFORMANCE_UPDATE":console.log("[GridKit DevTools] Performance update for table:",r.tableId);break;case"MEMORY_UPDATE":console.log("[GridKit DevTools] Memory update for table:",r.tableId);break;default:s.has(r.type)&&s.get(r.type).forEach(function(e){try{e(r)}catch(e){console.error("[GridKit DevTools] Error in message handler:",e)}})}}}}),console.log("[GridKit DevTools] Initializing content script"),a||((a=chrome.runtime.connect({name:"gridkit-devtools-content"})).onMessage.addListener(function(e){switch(console.log("[GridKit DevTools] Received from DevTools:",e),e.type){case"GET_TABLES":case"GET_STATE":l(e).then(function(e){a.postMessage(e)}).catch(function(e){a.postMessage({type:"ERROR",error:e.message})});break;default:a.postMessage({type:"ERROR",error:"Unknown command: "+e.type})}}),a.onDisconnect.addListener(function(){console.log("[GridKit DevTools] DevTools disconnected"),a=null}),console.log("[GridKit DevTools] Connected to DevTools panel")),o=c(),console.log("[GridKit DevTools] Found",o.length,"GridKit tables"),setInterval(function(){var e=c();console.log("[GridKit DevTools] Found",e.length,"GridKit tables (poll)")},2e3),window.__GRIDKIT_DEVTOOLS_CONTENT__={isConnected:function(){return r},detectTables:c,sendMessageToBackend:l,addMessageHandler:function(e,t){s.has(e)||s.set(e,new Set),s.get(e).add(t)},removeMessageHandler:function(e,t){s.has(e)&&s.get(e).delete(t)}}}function l(e){return new Promise(function(t,o){var r=Date.now()+Math.random(),i=setTimeout(function(){o(new Error("Backend message timeout"))},5e3),a=function(e){e.source===window&&e.data&&"RESPONSE"===e.data.type&&e.data.messageId===r&&(clearTimeout(i),window.removeEventListener("message",a),t(e.data.payload))};window.addEventListener("message",a),window.postMessage(n(n({},e),{},{source:"gridkit-devtools-content",messageId:r,timestamp:Date.now()}),"*")})}function c(){var o,n=[];if(window.__GRIDKIT_TABLES__ instanceof Map){var r,i=function(t){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=e(t))){o&&(t=o);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){o=o.call(t)},n:function(){var e=o.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==o.return||o.return()}finally{if(s)throw i}}}}(window.__GRIDKIT_TABLES__.values());try{for(i.s();!(r=i.n()).done;){var a=r.value;a&&"function"==typeof a.getState&&n.push(a)}}catch(e){i.e(e)}finally{i.f()}}(window.gridkitTables instanceof Array&&n.push.apply(n,function(e){if(Array.isArray(e))return t(e)}(o=window.gridkitTables)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||e(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),window.__REACT_DEVTOOLS_GLOBAL_HOOK__)&&window.__REACT_DEVTOOLS_GLOBAL_HOOK__.rendererIDToRenderer;return n}}(),GridKitDevTools={}})();
//# sourceMappingURL=content.js.map