{"version":3,"file":"content.js","mappings":"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","sources":["webpack://GridKitDevTools/./extension/content.js"],"sourcesContent":["// Content Script\n\nconsole.log('[GridKit DevTools] Content script loaded')\n\n;(() => {\n  // Check if DevTools is already connected\n  if (window.__GRIDKIT_DEVTOOLS_CONTENT__) {\n    console.log('[GridKit DevTools] Content script already loaded')\n    return\n  }\n\n  window.__GRIDKIT_DEVTOOLS_CONTENT__ = true\n\n// Connection state\nlet isConnected = false\nlet bridgePort = null\n\n// Message handlers\nconst messageHandlers = new Map()\n\n// Listen for messages from background script\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n  if (message.source !== 'gridkit-devtools-background') return\n\n  console.log('[GridKit DevTools] Content received:', message.type)\n\n  switch (message.type) {\n    case 'BACKEND_READY':\n      // Backend is ready, establish connection\n      connectToBackend()\n      sendResponse({ type: 'CONTENT_READY' })\n      break\n\n    case 'COMMAND':\n      // Forward to backend\n      sendMessageToBackend(message.payload)\n        .then((response) => {\n          sendResponse({\n            type: 'RESPONSE',\n            payload: response\n          })\n        })\n        .catch((error) => {\n          sendResponse({\n            type: 'RESPONSE',\n            payload: {\n              success: false,\n              error: error.message\n            }\n          })\n        })\n      return true\n\n    default:\n      console.warn('[GridKit DevTools] Unknown message type:', message.type)\n  }\n})\n\n// Listen for messages from backend (via window.postMessage)\nwindow.addEventListener('message', (event) => {\n  if (event.source !== window) return\n  if (!event.data || typeof event.data !== 'object') return\n  const source = event.data.source\n  if (source !== 'gridkit-devtools-backend' && source !== 'backend') return\n\n  console.log('[GridKit DevTools] Content received from backend:', event.data.type)\n\n  const message = event.data\n\n  switch (message.type) {\n    case 'TABLE_REGISTERED':\n      console.log('[GridKit DevTools] Table registered:', message.payload?.table?.id)\n      break\n\n    case 'TABLE_UNREGISTERED':\n      console.log('[GridKit DevTools] Table unregistered:', message.payload?.tableId)\n      break\n\n    case 'STATE_UPDATE':\n      console.log('[GridKit DevTools] State update for table:', message.tableId)\n      break\n\n    case 'EVENT_LOGGED':\n      console.log('[GridKit DevTools] Event logged for table:', message.tableId)\n      break\n\n    case 'PERFORMANCE_UPDATE':\n      console.log('[GridKit DevTools] Performance update for table:', message.tableId)\n      break\n\n    case 'MEMORY_UPDATE':\n      console.log('[GridKit DevTools] Memory update for table:', message.tableId)\n      break\n\n    default:\n      // Call registered handlers\n      if (messageHandlers.has(message.type)) {\n        messageHandlers.get(message.type).forEach((handler) => {\n          try {\n            handler(message)\n          } catch (error) {\n            console.error('[GridKit DevTools] Error in message handler:', error)\n          }\n        })\n      }\n  }\n})\n\n// Connect to backend\nfunction connectToBackend() {\n  if (isConnected) return\n\n  // Notify backend we're ready\n  window.postMessage(\n    {\n      source: 'gridkit-devtools-content',\n      type: 'CONTENT_READY',\n      timestamp: Date.now()\n    },\n    '*'\n  )\n\n  isConnected = true\n  console.log('[GridKit DevTools] Connected to backend')\n}\n\n// Send message to backend\nfunction sendMessageToBackend(message) {\n  return new Promise((resolve, reject) => {\n    // Store callback\n    const messageId = Date.now() + Math.random()\n    const timeout = setTimeout(() => {\n      reject(new Error('Backend message timeout'))\n    }, 5000)\n\n    const responseHandler = (event) => {\n      if (event.source !== window) return\n      if (!event.data || event.data.type !== 'RESPONSE') return\n      if (event.data.messageId !== messageId) return\n\n      clearTimeout(timeout)\n      window.removeEventListener('message', responseHandler)\n      resolve(event.data.payload)\n    }\n\n    window.addEventListener('message', responseHandler)\n\n    // Send message\n    window.postMessage(\n      {\n        ...message,\n        source: 'gridkit-devtools-content',\n        messageId,\n        timestamp: Date.now()\n      },\n      '*'\n    )\n  })\n}\n\n// Listen for DevTools panel connection\nfunction connectToDevTools() {\n  if (bridgePort) return\n\n  bridgePort = chrome.runtime.connect({\n    name: 'gridkit-devtools-content'\n  })\n\n  bridgePort.onMessage.addListener((message) => {\n    console.log('[GridKit DevTools] Received from DevTools:', message)\n\n    switch (message.type) {\n      case 'GET_TABLES':\n        sendMessageToBackend(message)\n          .then((response) => {\n            bridgePort.postMessage(response)\n          })\n          .catch((error) => {\n            bridgePort.postMessage({\n              type: 'ERROR',\n              error: error.message\n            })\n          })\n        break\n\n      case 'GET_STATE':\n        sendMessageToBackend(message)\n          .then((response) => {\n            bridgePort.postMessage(response)\n          })\n          .catch((error) => {\n            bridgePort.postMessage({\n              type: 'ERROR',\n              error: error.message\n            })\n          })\n        break\n\n      default:\n        bridgePort.postMessage({\n          type: 'ERROR',\n          error: 'Unknown command: ' + message.type\n        })\n    }\n  })\n\n  bridgePort.onDisconnect.addListener(() => {\n    console.log('[GridKit DevTools] DevTools disconnected')\n    bridgePort = null\n  })\n\n  console.log('[GridKit DevTools] Connected to DevTools panel')\n}\n\n// Detect GridKit tables on the page\nfunction detectGridKitTables() {\n  const tables = []\n\n  // Check for global tables registry\n  if (window.__GRIDKIT_TABLES__ instanceof Map) {\n    for (const table of window.__GRIDKIT_TABLES__.values()) {\n      if (table && typeof table.getState === 'function') {\n        tables.push(table)\n      }\n    }\n  }\n\n  // Check window for direct table references\n  if (window.gridkitTables instanceof Array) {\n    tables.push(...window.gridkitTables)\n  }\n\n  // Try to find via React DevTools\n  if (window.__REACT_DEVTOOLS_GLOBAL_HOOK__) {\n    const hook = window.__REACT_DEVTOOLS_GLOBAL_HOOK__\n    if (hook.rendererIDToRenderer) {\n      // Find GridKit tables in React components\n      findGridKitTablesInReact(hook, tables)\n    }\n  }\n\n  return tables\n}\n\n// Find GridKit tables in React components\nfunction findGridKitTablesInReact(hook, tables) {\n  // This is a simplified detection\n  // In production, you'd use the full React DevTools API\n}\n\n// Setup auto-detection\nfunction setupAutoDetection() {\n  // Register existing tables\n  const tables = detectGridKitTables()\n  console.log('[GridKit DevTools] Found', tables.length, 'GridKit tables')\n\n  // Poll for new tables\n  const intervalId = setInterval(() => {\n    const tables = detectGridKitTables()\n    console.log('[GridKit DevTools] Found', tables.length, 'GridKit tables (poll)')\n  }, 2000)\n\n  return intervalId\n}\n\n// Initialize\nconsole.log('[GridKit DevTools] Initializing content script')\nconnectToDevTools()\n\n// Setup auto-detection\nsetupAutoDetection()\n\n// Expose API for external use\n  window.__GRIDKIT_DEVTOOLS_CONTENT__ = {\n    isConnected: () => isConnected,\n    detectTables: detectGridKitTables,\n    sendMessageToBackend: sendMessageToBackend,\n    addMessageHandler: (type, handler) => {\n      if (!messageHandlers.has(type)) {\n        messageHandlers.set(type, new Set())\n      }\n      messageHandlers.get(type).add(handler)\n    },\n    removeMessageHandler: (type, handler) => {\n      if (messageHandlers.has(type)) {\n        messageHandlers.get(type).delete(handler)\n      }\n    }\n  }\n})()\n"],"names":["console","log","window","__GRIDKIT_DEVTOOLS_CONTENT__","tables","isConnected","bridgePort","messageHandlers","Map","chrome","runtime","onMessage","addListener","message","sender","sendResponse","source","type","postMessage","timestamp","Date","now","sendMessageToBackend","payload","then","response","error","success","warn","addEventListener","event","_message$payload","_message$payload2","data","_typeof","table","id","tableId","has","get","forEach","handler","connect","name","onDisconnect","detectGridKitTables","length","setInterval","detectTables","addMessageHandler","set","Set","add","removeMessageHandler","Promise","resolve","reject","messageId","Math","random","timeout","setTimeout","Error","responseHandler","clearTimeout","removeEventListener","_objectSpread","__GRIDKIT_TABLES__","_step","_iterator","_createForOfIteratorHelper","values","s","n","done","value","getState","push","err","e","f","gridkitTables","Array","apply","__REACT_DEVTOOLS_GLOBAL_HOOK__","rendererIDToRenderer"],"sourceRoot":""}