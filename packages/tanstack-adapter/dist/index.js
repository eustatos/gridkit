"use strict";var T=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var B=Object.prototype.hasOwnProperty;var q=(e,a)=>{for(var t in a)T(e,t,{get:a[t],enumerable:!0})},O=(e,a,t,r)=>{if(a&&typeof a=="object"||typeof a=="function")for(let n of V(a))!B.call(e,n)&&n!==t&&T(e,n,{get:()=>a[n],enumerable:!(r=S(a,n))||r.enumerable});return e};var F=e=>O(T({},"__esModule",{value:!0}),e);var U={};q(U,{createDefaultEnhancedTable:()=>E,createEnhancedTable:()=>u,createEnhancedTableFromOptions:()=>b,useGridEnhancedTable:()=>A,useTableEvents:()=>G,useTableMetrics:()=>W,useValidation:()=>K,withEvents:()=>v,withPerformanceMonitoring:()=>R,withPlugins:()=>P,withValidation:()=>x});module.exports=F(U);var d=require("react"),C=require("@tanstack/react-table");var p=require("@gridkit/core/events"),g=require("@gridkit/core/performance"),h=require("@gridkit/core/validation"),D=require("@gridkit/core/plugin"),f=class{constructor(a,t,r){this.table=a,this.eventBus=t,this.performanceMonitor=r}intercept(a,t){let r=this.table[a];return((...n)=>{t?.before?.(n),t?.emitStart&&this.eventBus.emit(`${String(a)}:start`,{args:n});let o=this.performanceMonitor?this.performanceMonitor.track(String(a),()=>r(...n)):r(...n);return t?.after?.(o),t?.emitComplete&&this.eventBus.emit(`${String(a)}:complete`,{result:o}),o})}};function u(e,a){let t,r,n,o;if(a?.events){let i=typeof a.events=="boolean"?{}:a.events;t=(0,p.createEventBus)({devMode:i.devMode??!0}),i.middleware&&i.middleware.forEach(l=>{t.use(l)})}if(a?.performance){let i=typeof a.performance=="boolean"?{}:a.performance,l={enabled:!0,budgets:{tableCreation:100,stateUpdate:50,renderCycle:16,rowModelBuild:30,eventProcessing:10,...i.budgets},onViolation:i.onViolation};r=(0,g.createPerformanceMonitor)(l)}if(a?.validation){let i=typeof a.validation=="boolean"?{}:a.validation;n=new h.ValidationManager({defaultMode:i.mode||"normal",cacheEnabled:i.cache??!0,throwOnError:i.throwOnError??!1})}a?.plugins&&a.plugins.length>0&&(o=new D.PluginManager,a.plugins.forEach(i=>{o.register(i)}));let s=new f(e,t,r),c={...e,on:t?.on.bind(t),off:t?.off.bind(t),emit:t?.emit.bind(t),use:t?.use.bind(t),getStats:t?(()=>t.getStats()):void 0,metrics:r,validator:n,validateRow:n?((i,l)=>n.validateRow(i,l)):void 0,validateAll:n?(()=>n.validateAll()):void 0,registerPlugin:o?.register.bind(o),unregisterPlugin:o?.unregister.bind(o),getPlugin:o?.get.bind(o),pluginManager:o};return["setSorting","setFiltering","setPagination","setGrouping","setColumnVisibility","setColumnPinning"].forEach(i=>{i in e&&(c[i]=s.intercept(i,{emitStart:!0,emitComplete:!0}))}),c}function b(e){let{useReactTable:a}=require("@tanstack/react-table"),{features:t,...r}=e,n=a(r);return u(n,t)}function E(e){return b({...e,features:{events:!0,performance:!0,validation:!0,...e.features}})}var y=require("@gridkit/core/events");function v(e,a){let t=typeof a=="boolean"?{}:a??{},r=(0,y.createEventBus)({devMode:t.devMode??!0});return t.middleware&&t.middleware.forEach(o=>{r.use(o)}),{...e,on:(o,s)=>r.on(o,s),off:(o,s)=>{r.off(o,s)},emit:(o,s,c)=>{r.emit(o,s,c)},use:o=>r.use(o),getStats:()=>r.getStats()}}var w=require("@gridkit/core/performance");function R(e,a){let t=typeof a=="boolean"?{}:a,r={enabled:!0,budgets:{tableCreation:100,stateUpdate:50,renderCycle:16,rowModelBuild:30,eventProcessing:10,...t.budgets},onViolation:t.onViolation},n=(0,w.createPerformanceMonitor)(r),o=["getRowModel","getSortedRowModel","getFilteredRowModel"],s={...e};return o.forEach(c=>{s[c]=((...m)=>n.track(String(c),()=>e[c](...m)))}),s.metrics={...n,getMetrics:()=>n.getMetrics(),checkBudgets:()=>n.checkBudgets(),setBudgets:c=>n.setBudgets(c)},s}var M=require("@gridkit/core/validation");function x(e,a){let t=new M.ValidationManager({defaultMode:a?.mode||"normal",cacheEnabled:a?.cache??!0,throwOnError:a?.throwOnError??!1});return{...e,validator:t,validateRow:async(n,o)=>t.validateRow(n,o),validateAll:async()=>{let n=e.getRowModel?.().rows||[];return t.validateArray(n)}}}var k=require("@gridkit/core/plugin");function P(e,a=[]){let t=new k.PluginManager;return a.forEach(n=>{t.register(n)}),{...e,registerPlugin:n=>{t.register(n)},unregisterPlugin:n=>{t.unregister(n)},getPlugin:n=>t.get(n),pluginManager:t}}function A(e){let{features:a,...t}=e,r=(0,C.useReactTable)(t);return(0,d.useMemo)(()=>u(r,a),[r,a])}function W(e){return(0,d.useMemo)(()=>({getOperationStats:a=>e.metrics?.getOperationStats(a),getMemoryMetrics:()=>e.metrics?.getMemoryMetrics()}),[e.metrics])}function K(e){return(0,d.useMemo)(()=>({validateRow:async(a,t)=>{if(!e.validateRow)throw new Error("Validation not enabled");return e.validateRow(a,t)},validateAll:async()=>{if(!e.validateAll)throw new Error("Validation not enabled");return e.validateAll()},validator:e.validator}),[e.validateRow,e.validateAll,e.validator])}function G(e){return(0,d.useMemo)(()=>({on:e.on,off:e.off,emit:e.emit,use:e.use}),[e.on,e.off,e.emit,e.use])}
//# sourceMappingURL=index.js.map