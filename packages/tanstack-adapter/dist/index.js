var p=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var le=Object.prototype.hasOwnProperty;var se=(e,t)=>{for(var a in t)p(e,a,{get:t[a],enumerable:!0})},ue=(e,t,a,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ie(t))!le.call(e,n)&&n!==a&&p(e,n,{get:()=>t[n],enumerable:!(o=re(t,n))||o.enumerable});return e};var ce=e=>ue(p({},"__esModule",{value:!0}),e);var ve={};se(ve,{composeColumnEnhancers:()=>S,createDefaultEnhancedTable:()=>me,createEnhancedColumn:()=>oe,createEnhancedTable:()=>f,createEnhancedTableFromOptions:()=>B,createEnhancedTableWithEvents:()=>pe,createEnhancedTableWithPerformance:()=>be,createEnhancedTableWithPlugins:()=>Ce,createEnhancedTableWithValidation:()=>he,enhanceColumn:()=>Q,formatters:()=>ee,useEnhancedFeatures:()=>$,useEnhancedTable:()=>Te,useGridEnhancedTable:()=>Y,useTableBudgets:()=>K,useTableEvents:()=>g,useTableMetrics:()=>h,useTablePerformance:()=>A,useTablePlugin:()=>I,useTableSelection:()=>z,useTableState:()=>G,useTableStats:()=>W,useTableValidation:()=>y,useTableWithEvents:()=>De,useTableWithPerformance:()=>ge,useTableWithPlugins:()=>we,useTableWithValidation:()=>ye,withColumnEvents:()=>te,withColumnFormat:()=>Z,withColumnMetadata:()=>ae,withColumnPerformance:()=>ne,withColumnValidation:()=>X,withEvents:()=>w,withPerformanceMonitoring:()=>x,withPlugins:()=>M,withValidation:()=>E});module.exports=ce(ve);var u=require("react"),F=require("@tanstack/react-table");var O=require("react"),b=require("@tanstack/react-table");function de(){return`gridkit-table-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}var D=class{constructor(t,a,o){this.table=t,this.eventBus=a,this.performanceMonitor=o}intercept(t,a){let o=this.table[t];return((...n)=>{a?.before?.(n),a?.emitStart&&this.eventBus&&this.eventBus.emit(`${String(t)}:start`,{args:n});let r=this.performanceMonitor?this.performanceMonitor.track(String(t),()=>o(...n)):o(...n);return a?.after?.(r),a?.emitComplete&&this.eventBus&&this.eventBus.emit(`${String(t)}:complete`,{result:r}),r})}};function f(e,t,a){let o=a?.tableId||a?.debug?.devtools?.tableId||de(),n={...e.options,tableId:o,debug:{...e.options.debug,devtools:{enabled:!0,tableId:o,...e.options.debug?.devtools}}},r,i,l,s;if(t?.events){let c=typeof t.events=="boolean"?{}:t.events;r={on:(d,P)=>()=>{},off:(d,P)=>{},emit:(d,P)=>{},use:d=>()=>{}},c.middleware&&c.middleware.forEach(d=>{r.use(d)})}t?.performance&&(i={track:(c,d)=>d(),getMetrics:()=>({}),checkBudgets:()=>[],setBudgets:c=>{},clear:()=>{}}),t?.validation&&(l={validateRow:(c,d)=>Promise.resolve({valid:!0,errors:[]}),validateAll:()=>Promise.resolve({valid:!0,errors:[]})}),t?.plugins&&t.plugins.length>0&&(s={register:c=>{},unregister:c=>{},get:c=>{}},t.plugins.forEach(c=>{s.register(c)}));let m=new D(e,r,i),T={...e,on:r?.on,off:r?.off,emit:r?.emit,use:r?.use,getStats:r?(()=>({})):void 0,metrics:i,validator:l,validateRow:l?((c,d)=>l.validateRow(c,d)):void 0,validateAll:l?(()=>l.validateAll()):void 0,registerPlugin:s?.register,unregisterPlugin:s?.unregister,getPlugin:s?.get,pluginManager:s,options:n};return["setSorting","setFiltering","setPagination","setGrouping","setColumnVisibility","setColumnPinning"].forEach(c=>{c in e&&(T[c]=m.intercept(c,{emitStart:!0,emitComplete:!0}))}),T}function B(e){let{features:t,...a}=e,o=(0,b.useReactTable)(a);return f(o,t,e)}function me(e){return B({...e,features:{events:!0,performance:!0,validation:!0,...e.features}})}function Te(e){let{features:t,...a}=e,o=(0,b.useReactTable)(a);return(0,O.useMemo)(()=>f(o,t,e),[o,t,e])}function Y(e){let{features:t,...a}=e,o=(0,F.useReactTable)(a),n=(0,u.useMemo)(()=>f(o,t),[o,t]);return(0,u.useEffect)(()=>{if(typeof window>"u")return;let r=window.__GRIDKIT_DEVTOOLS__;if(!r)return;let i=n.on?.("performance:measured",l=>{r.sendPerformanceUpdate?.(n.id,l)});return()=>{i?.()}},[n]),(0,u.useEffect)(()=>()=>{n.emit?.("table:destroy",{tableId:"unknown"}),n.metrics?.clear?.()},[n,o.options.meta,t]),n}function g(e,t){(0,u.useEffect)(()=>{if(!e.on||!e.off)return;let a=[];return Object.entries(t).forEach(([o,n])=>{if(!e.on)return;let r=e.on(o,n);r&&a.push(r)}),()=>{a.forEach(o=>o())}},[e,t])}function h(e,t){let[a,o]=fe(e.metrics);return(0,u.useEffect)(()=>{if(!t||!e.metrics)return;let n=setInterval(()=>{if(!e.metrics)return;let r=e.metrics.getMetrics?.();o(r)},t);return()=>clearInterval(n)},[t,e.metrics]),a}function fe(e){let[t,a]=(0,u.useState)(e?.getMetrics?.()??void 0);return(0,u.useEffect)(()=>{e&&a(e.getMetrics?.())},[e]),t}function y(e,t=!1){let[a,o]=(0,u.useState)(),[n,r]=(0,u.useState)(!1),i=(0,u.useCallback)(async()=>{if(!e.validateAll&&!e.validator?.validateAll)throw new Error("Validation not enabled");r(!0);try{let l=await e.validateAll?.();return o(l),l}finally{r(!1)}},[e.validateAll,e.validator]);return(0,u.useEffect)(()=>{t&&i()},[e.options.data,t,i]),{report:a,validate:i,isValidating:n}}function I(e,t){let[a,o]=(0,u.useState)();return(0,u.useEffect)(()=>{if(!e.getPlugin)return;let n=e.getPlugin(t);o(n)},[e,t]),a}function $(e,t){g(e,t?.events||{});let a=h(e,t?.metricsInterval),o=y(e,t?.autoValidate);return(0,u.useMemo)(()=>({metrics:a,validation:o}),[a,o])}function A(e,t){(0,u.useEffect)(()=>{if(!e.metrics||!t)return;Object.entries(t).forEach(([n,r])=>{e.metrics&&e.metrics.setBudgets?.({operations:{[n]:r.maxTime}})});let a=n=>{console.warn("Performance budget exceeded:",n.payload)},o=e.on&&e.on("performance:budget:exceeded",a);return()=>o?.()},[e,t])}function G(e,t){(0,u.useEffect)(()=>{if(!e.on)return;let a=o=>{(o.type==="table:state"||o.type==="table:update")&&t(o.payload)};return e.on?.("table:state",a),e.on?.("table:update",a),()=>{e.off?.("table:state",a),e.off?.("table:update",a)}},[e,t])}function z(e){let[t,a]=(0,u.useState)([]);(0,u.useEffect)(()=>{let r=e.getState?.()?.rowSelection??{},i=Array.isArray(r)?r:Object.keys(r);a(i)},[e]);let o=(0,u.useCallback)((n,r)=>{if(!e.setRowSelection){console.warn("Selection not supported");return}a(i=>r?Array.from(new Set([...i,n])):i.filter(l=>l!==n)),e.setRowSelection((i={})=>{if(r)return{...i,[n]:!0};{let{[n]:l,...s}=i;return s}})},[e]);return[t,o]}function W(e){let[t,a]=(0,u.useState)({totalOperations:0,avgTime:void 0,peakTime:void 0,operations:{}});return(0,u.useEffect)(()=>{if(!e.metrics){a({totalOperations:0,avgTime:void 0,peakTime:void 0,operations:{}});return}let o=e.metrics.getMetrics?.();if(o&&o.operations){let n=0,r=0,i=0,l={};Object.entries(o.operations).forEach(([s,m])=>{n+=m.count||0,r+=m.totalTime||0;let T=m.maxTime||0;T>i&&(i=T),l[s]=m.count||0}),a({totalOperations:n,avgTime:n>0?r/n:void 0,peakTime:i>0?i:void 0,operations:l})}},[e.metrics]),t}function K(e){let[t,a]=(0,u.useState)({}),[o,n]=(0,u.useState)([]);(0,u.useEffect)(()=>{if(!e.metrics)return;let l=e.metrics.getMetrics?.()?.budgets??{};a(l);let s=e.metrics.checkBudgets?.()??[];n(s);let m=T=>{n(R=>[...R,T.payload])};return e.on?.("performance:budget:exceeded",m),()=>{e.off?.("performance:budget:exceeded",m)}},[e.metrics]);let r=(0,u.useCallback)(()=>{if(!e.metrics)return[];let i=e.metrics.checkBudgets?.()??[];return n(i),i},[e.metrics]);return{budgets:t,violations:o,check:r}}var U=require("@gridkit/core/events"),_=require("react"),C=require("@tanstack/react-table");function w(e,t){let o=(0,U.createEventBus)({devMode:(typeof t=="boolean"?{}:t??{}).devMode??!0});return{...e,on:(r,i)=>o.on(r,i),off:(r,i)=>{o.off(r,i)},emit:(r,i,l)=>{o.emit(r,i,l)},use:r=>o.use(r),getStats:()=>o.getStats()}}function pe(e,t){let a=(0,C.useReactTable)(e);return w(a,t)}function De(e,t){let a=(0,C.useReactTable)(e);return(0,_.useMemo)(()=>w(a,t),[a,t])}var j=require("@gridkit/core/performance"),N=require("react"),v=require("@tanstack/react-table");function x(e,t){let a=typeof t=="boolean"?{}:t,o={enabled:!0,budgets:{tableCreation:100,stateUpdate:50,renderCycle:16,rowModelBuild:30,eventProcessing:10,...a.budgets},onViolation:a.onViolation},n=(0,j.createPerformanceMonitor)(o),r=["getRowModel","getSortedRowModel","getFilteredRowModel"],i={...e};return r.forEach(l=>{i[l]=((...s)=>n.track(String(l),()=>e[l](...s)))}),i.metrics={...n,getMetrics:()=>n.getMetrics(),checkBudgets:()=>n.checkBudgets(),setBudgets:l=>n.setBudgets(l)},i}function be(e,t){let a=(0,v.useReactTable)(e);return x(a,t)}function ge(e,t){let a=(0,v.useReactTable)(e);return(0,N.useMemo)(()=>x(a,t),[a,t])}var L=require("@gridkit/core/validation"),H=require("react"),V=require("@tanstack/react-table");function E(e,t){let a=(0,L.createValidationManager)({defaultMode:t?.mode||"normal",cacheEnabled:t?.cache??!0,throwOnError:t?.throwOnError??!1});return{...e,validator:a,validateRow:async(n,r)=>a.validateRow(n,r),validateAll:async()=>{let n=e.getRowModel?.().rows||[];return a.validateArray(n)}}}function he(e,t){let a=(0,V.useReactTable)(e);return E(a,t)}function ye(e,t){let a=(0,V.useReactTable)(e);return(0,H.useMemo)(()=>E(a,t),[a,t])}var J=require("@gridkit/core/plugin"),q=require("react"),k=require("@tanstack/react-table");function M(e,t=[]){let a=new J.PluginManager;return t.forEach(n=>{a.register(n)}),{...e,registerPlugin:n=>{a.register(n)},unregisterPlugin:n=>{a.unregister(n)},getPlugin:n=>a.get(n),pluginManager:a}}function Ce(e,t=[]){let a=(0,k.useReactTable)(e);return M(a,t)}function we(e,t=[]){let a=(0,k.useReactTable)(e);return(0,q.useMemo)(()=>M(a,t),[a,t])}function Q(e,t){return{...e,...t,cell:a=>{let o=typeof e.cell=="function"?e.cell(a):a.getValue();if(t?.validation&&t.validateCell){let n=a.getValue();t.validateCell(n,a.row.original)}return t?.format?t.format(a.getValue()):o},meta:{...e.meta,...t?.meta}}}function X(e,t,a){return{...e,validation:t,validateCell:async(o,n)=>{let i={[e.id||"field"]:o};return t.validate(i)},cell:o=>{let n=typeof e.cell=="function"?e.cell(o):o.getValue(),r=o.getValue(),l={[e.id||"field"]:r};try{let s=t.validate(l);return typeof n!="object"||n===null?{content:n,isValid:s.valid,errorMessage:s.valid?void 0:s.errors[0]?.message}:n}catch(s){return{content:n,isValid:!1,errorMessage:s instanceof Error?s.message:"Validation failed"}}}}}function Z(e,t,a){return{...e,format:t,parse:a}}var ee={currency:(e=2,t="$")=>a=>`${t}${a.toFixed(e)}`,percentage:(e=1,t=!0)=>a=>`${(t?a*100:a).toFixed(e)}%`,date:(e="YYYY-MM-DD")=>t=>{let a=typeof t=="string"||typeof t=="number"?new Date(t):t;if(isNaN(a.getTime()))return"";switch(e){case"ISO":return a.toISOString();case"MM/DD/YYYY":return`${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getDate().toString().padStart(2,"0")}/${a.getFullYear()}`;case"DD/MM/YYYY":return`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()}`;default:return a.toISOString().split("T")[0]}},truncate:(e=50,t="...")=>a=>a.length>e?`${a.slice(0,e-t.length)}${t}`:a,uppercase:()=>e=>e.toUpperCase(),lowercase:()=>e=>e.toLowerCase(),number:(e=2,t=!0)=>a=>a.toLocaleString(void 0,{minimumFractionDigits:e,maximumFractionDigits:e,useGrouping:t}),fileSize:(e=2)=>t=>{if(t===0)return"0 Bytes";let a=1024,o=["Bytes","KB","MB","GB","TB"],n=Math.floor(Math.log(t)/Math.log(a));return(t/Math.pow(a,n)).toFixed(e).replace(/\.?0+$/,"")+" "+o[n]},phoneNumber:()=>e=>{let t=e.replace(/\D/g,"");return t.length===10?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:t.length===11&&t.startsWith("1")?`+1 (${t.slice(1,4)}) ${t.slice(4,7)}-${t.slice(7)}`:e},boolean:(e="Yes",t="No")=>a=>a?e:t,capitalize:()=>e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()};function te(e,t,a){return{...e,eventEmitter:t,onCellEdit:a?.onEdit,onCellClick:a?.onClick,onCellFocus:a?.onFocus,cell:o=>{let n=typeof e.cell=="function"?e.cell(o):o.getValue(),r=o.getValue(),i=o.row.original,l=o.row.index;return t.emit({type:"cell:render",payload:{columnId:e.id,value:r,row:i,rowIndex:l}}),a?.onClick&&t.emit({type:"cell:click",payload:{columnId:e.id,value:r,row:i,rowIndex:l}}),n}}}function ae(e,t){return{...e,meta:{...e.meta,...t}}}function ne(e,t){let a=new Map,o=new Map,n=t?.cacheable??!0,r=t?.memoize??!0;return{...e,cacheable:n,memoize:r,cell:i=>{if(n){let s=`${i.row.id}-${e.id}`;if(a.has(s))return a.get(s)}let l=typeof e.cell=="function"?e.cell(i):i.getValue();if(n){let s=`${i.row.id}-${e.id}`;a.set(s,l)}if(r){let s=JSON.stringify(i.row.original);if(o.has(s))return o.get(s);o.set(s,l)}return l}}}function S(...e){return t=>e.reduce((a,o)=>o(a),t)}function oe(e,...t){return S(...t)(e)}
//# sourceMappingURL=index.js.map