var m=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,a)=>(typeof require<"u"?require:t)[a]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});import{useMemo as d}from"react";import{useReactTable as C}from"@tanstack/react-table";import{createEventBus as p}from"@gridkit/core/events";import{createPerformanceMonitor as g}from"@gridkit/core/performance";import{ValidationManager as h}from"@gridkit/core/validation";import{PluginManager as D}from"@gridkit/core/plugin";var u=class{constructor(t,a,o){this.table=t,this.eventBus=a,this.performanceMonitor=o}intercept(t,a){let o=this.table[t];return((...n)=>{a?.before?.(n),a?.emitStart&&this.eventBus.emit(`${String(t)}:start`,{args:n});let r=this.performanceMonitor?this.performanceMonitor.track(String(t),()=>o(...n)):o(...n);return a?.after?.(r),a?.emitComplete&&this.eventBus.emit(`${String(t)}:complete`,{result:r}),r})}};function T(e,t){let a,o,n,r;if(t?.events){let i=typeof t.events=="boolean"?{}:t.events;a=p({devMode:i.devMode??!0}),i.middleware&&i.middleware.forEach(l=>{a.use(l)})}if(t?.performance){let i=typeof t.performance=="boolean"?{}:t.performance,l={enabled:!0,budgets:{tableCreation:100,stateUpdate:50,renderCycle:16,rowModelBuild:30,eventProcessing:10,...i.budgets},onViolation:i.onViolation};o=g(l)}if(t?.validation){let i=typeof t.validation=="boolean"?{}:t.validation;n=new h({defaultMode:i.mode||"normal",cacheEnabled:i.cache??!0,throwOnError:i.throwOnError??!1})}t?.plugins&&t.plugins.length>0&&(r=new D,t.plugins.forEach(i=>{r.register(i)}));let s=new u(e,a,o),c={...e,on:a?.on.bind(a),off:a?.off.bind(a),emit:a?.emit.bind(a),use:a?.use.bind(a),getStats:a?(()=>a.getStats()):void 0,metrics:o,validator:n,validateRow:n?((i,l)=>n.validateRow(i,l)):void 0,validateAll:n?(()=>n.validateAll()):void 0,registerPlugin:r?.register.bind(r),unregisterPlugin:r?.unregister.bind(r),getPlugin:r?.get.bind(r),pluginManager:r};return["setSorting","setFiltering","setPagination","setGrouping","setColumnVisibility","setColumnPinning"].forEach(i=>{i in e&&(c[i]=s.intercept(i,{emitStart:!0,emitComplete:!0}))}),c}function b(e){let{useReactTable:t}=m("@tanstack/react-table"),{features:a,...o}=e,n=t(o);return T(n,a)}function E(e){return b({...e,features:{events:!0,performance:!0,validation:!0,...e.features}})}import{createEventBus as y}from"@gridkit/core/events";function v(e,t){let a=typeof t=="boolean"?{}:t??{},o=y({devMode:a.devMode??!0});return a.middleware&&a.middleware.forEach(r=>{o.use(r)}),{...e,on:(r,s)=>o.on(r,s),off:(r,s)=>{o.off(r,s)},emit:(r,s,c)=>{o.emit(r,s,c)},use:r=>o.use(r),getStats:()=>o.getStats()}}import{createPerformanceMonitor as w}from"@gridkit/core/performance";function R(e,t){let a=typeof t=="boolean"?{}:t,o={enabled:!0,budgets:{tableCreation:100,stateUpdate:50,renderCycle:16,rowModelBuild:30,eventProcessing:10,...a.budgets},onViolation:a.onViolation},n=w(o),r=["getRowModel","getSortedRowModel","getFilteredRowModel"],s={...e};return r.forEach(c=>{s[c]=((...f)=>n.track(String(c),()=>e[c](...f)))}),s.metrics={...n,getMetrics:()=>n.getMetrics(),checkBudgets:()=>n.checkBudgets(),setBudgets:c=>n.setBudgets(c)},s}import{ValidationManager as M}from"@gridkit/core/validation";function x(e,t){let a=new M({defaultMode:t?.mode||"normal",cacheEnabled:t?.cache??!0,throwOnError:t?.throwOnError??!1});return{...e,validator:a,validateRow:async(n,r)=>a.validateRow(n,r),validateAll:async()=>{let n=e.getRowModel?.().rows||[];return a.validateArray(n)}}}import{PluginManager as k}from"@gridkit/core/plugin";function P(e,t=[]){let a=new k;return t.forEach(n=>{a.register(n)}),{...e,registerPlugin:n=>{a.register(n)},unregisterPlugin:n=>{a.unregister(n)},getPlugin:n=>a.get(n),pluginManager:a}}function N(e){let{features:t,...a}=e,o=C(a);return d(()=>T(o,t),[o,t])}function ee(e){return d(()=>({getOperationStats:t=>e.metrics?.getOperationStats(t),getMemoryMetrics:()=>e.metrics?.getMemoryMetrics()}),[e.metrics])}function ae(e){return d(()=>({validateRow:async(t,a)=>{if(!e.validateRow)throw new Error("Validation not enabled");return e.validateRow(t,a)},validateAll:async()=>{if(!e.validateAll)throw new Error("Validation not enabled");return e.validateAll()},validator:e.validator}),[e.validateRow,e.validateAll,e.validator])}function te(e){return d(()=>({on:e.on,off:e.off,emit:e.emit,use:e.use}),[e.on,e.off,e.emit,e.use])}export{E as createDefaultEnhancedTable,T as createEnhancedTable,b as createEnhancedTableFromOptions,N as useGridEnhancedTable,te as useTableEvents,ee as useTableMetrics,ae as useValidation,v as withEvents,R as withPerformanceMonitoring,P as withPlugins,x as withValidation};
//# sourceMappingURL=index.mjs.map